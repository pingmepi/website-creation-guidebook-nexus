(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15288,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(75157);let s=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("div",{ref:s,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...r}));s.displayName="Card";let i=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("div",{ref:s,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",e),...r}));i.displayName="CardHeader";let l=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("h3",{ref:s,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",e),...r}));l.displayName="CardTitle";let o=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("p",{ref:s,className:(0,a.cn)("text-sm text-muted-foreground",e),...r}));o.displayName="CardDescription";let c=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("div",{ref:s,className:(0,a.cn)("p-6 pt-0",e),...r}));c.displayName="CardContent";let n=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("div",{ref:s,className:(0,a.cn)("flex items-center p-6 pt-0",e),...r}));n.displayName="CardFooter",e.s(["Card",()=>s,"CardContent",()=>c,"CardDescription",()=>o,"CardFooter",()=>n,"CardHeader",()=>i,"CardTitle",()=>l])},99682,e=>{"use strict";var t=e.i(71645);function r(e){let r=t.useRef({value:e,previous:e});return t.useMemo(()=>(r.current.value!==e&&(r.current.previous=r.current.value,r.current.value=e),r.current.previous),[e])}e.s(["usePrevious",()=>r])},53788,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(15288),s=e.i(19455),i=e.i(86536),l=e.i(1928),o=e.i(43531),c=e.i(33277),n=e.i(75144),d=e.i(76639);let u=({children:e,image:r,alt:a})=>(0,t.jsxs)(d.Dialog,{children:[(0,t.jsx)(d.DialogTrigger,{asChild:!0,children:e}),(0,t.jsx)(d.DialogContent,{className:"max-w-3xl w-full max-h-[90vh] p-0",children:(0,t.jsx)("div",{className:"relative",children:(0,t.jsx)("img",{src:r,alt:a,className:"w-full h-auto object-contain rounded-lg"})})})]});var m=e.i(67489),h=e.i(41867),x=e.i(8406);let f=({children:e,product:a,onAddToCart:i})=>{let[o,c]=(0,r.useState)(""),[n,u]=(0,r.useState)(1),{sizes:f,colors:g,loading:p,selectedSize:v,setSelectedSize:j,checkStock:b}=function(e){let[t,a]=(0,r.useState)([]),[s,i]=(0,r.useState)([]),[l,o]=(0,r.useState)(!1),[c,n]=(0,r.useState)("");return(0,r.useEffect)(()=>{e&&(async()=>{o(!0);try{let{data:t,error:r}=await h.supabase.rpc("get_product_sizes",{product_uuid:e});if(r)return void console.error("Error fetching product sizes:",r);a(t||[]),t&&t.length>0&&n(t[0].size)}catch(e){console.error("Error fetching product sizes:",e)}finally{o(!1)}})()},[e]),(0,r.useEffect)(()=>{e&&c&&(async()=>{try{let{data:t,error:r}=await h.supabase.rpc("get_product_colors",{product_uuid:e,size_param:c});if(r)return void console.error("Error fetching product colors:",r);i(t||[])}catch(e){console.error("Error fetching product colors:",e)}})()},[e,c]),{sizes:t,colors:s,loading:l,selectedSize:c,setSelectedSize:n,checkStock:async(e,t=1)=>{try{let{data:r,error:a}=await h.supabase.rpc("check_variant_stock",{variant_uuid:e,requested_quantity:t});if(a)return console.error("Error checking stock:",a),!1;return r}catch(e){return console.error("Error checking stock:",e),!1}}}}(a.id),C=async()=>{if(!v)return void(0,x.toast)({title:"Please select a size",variant:"destructive"});let e=g.find(e=>o?e.color_hex===o:e.variant_id);e?await b(e.variant_id,n)?i(e.variant_id,n):(0,x.toast)({title:"Out of stock",description:"This item is currently out of stock",variant:"destructive"}):(0,x.toast)({title:"Product not available",description:"Selected size/color combination is not available",variant:"destructive"})};return(0,t.jsxs)(d.Dialog,{children:[(0,t.jsx)(d.DialogTrigger,{asChild:!0,children:e}),(0,t.jsxs)(d.DialogContent,{className:"max-w-2xl",children:[(0,t.jsx)(d.DialogHeader,{children:(0,t.jsx)(d.DialogTitle,{children:a.name})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsx)("div",{className:"aspect-square",children:(0,t.jsx)("img",{src:a.image,alt:a.name,className:"w-full h-full object-cover rounded-lg"})}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xl font-semibold",children:a.name}),(0,t.jsx)("p",{className:"text-2xl font-bold text-primary mt-2",children:a.price})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium mb-2",children:"Description"}),(0,t.jsx)("p",{className:"text-muted-foreground text-sm",children:"Premium quality t-shirt made from 100% cotton. Comfortable fit with excellent durability and softness."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium mb-2",children:"Size"}),(0,t.jsxs)(m.Select,{value:v,onValueChange:j,disabled:p,children:[(0,t.jsx)(m.SelectTrigger,{className:"w-full",children:(0,t.jsx)(m.SelectValue,{placeholder:p?"Loading sizes...":"Select size"})}),(0,t.jsx)(m.SelectContent,{children:f.map(e=>(0,t.jsxs)(m.SelectItem,{value:e.size,disabled:0===e.available_stock,children:[e.size," ",0===e.available_stock?"(Out of Stock)":`(${e.available_stock} available)`]},e.size))})]})]}),v&&g.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium mb-2",children:"Color"}),(0,t.jsxs)(m.Select,{value:o,onValueChange:c,children:[(0,t.jsx)(m.SelectTrigger,{className:"w-full",children:(0,t.jsx)(m.SelectValue,{placeholder:"Select color"})}),(0,t.jsx)(m.SelectContent,{children:g.map(e=>(0,t.jsx)(m.SelectItem,{value:e.color_hex,disabled:0===e.stock_quantity,children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-4 h-4 rounded border",style:{backgroundColor:e.color_hex}}),e.color_name," (",e.stock_quantity," available)"]})},e.variant_id))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium mb-2",children:"Quantity"}),(0,t.jsxs)(m.Select,{value:n.toString(),onValueChange:e=>u(parseInt(e)),children:[(0,t.jsx)(m.SelectTrigger,{className:"w-full",children:(0,t.jsx)(m.SelectValue,{})}),(0,t.jsx)(m.SelectContent,{children:[1,2,3,4,5].map(e=>(0,t.jsx)(m.SelectItem,{value:e.toString(),children:e},e))})]})]}),(0,t.jsxs)(s.Button,{onClick:C,className:"w-full flex items-center gap-2",disabled:!v||p,children:[(0,t.jsx)(l.ShoppingCart,{size:20}),"Add to Cart"]})]})]})]})]})};e.s(["default",0,({id:e,name:d,price:m,image:x,colorOptions:g=["#FFFFFF","#000000","#DC2626"]})=>{let[p,v]=(0,r.useState)(g[0]),[j,b]=(0,r.useState)(!1),[C,N]=(0,r.useState)(!1),{isAuthenticated:S}=(0,c.useUser)(),{addToCart:y}=(0,n.useCart)(),w=async()=>{if(!S)return void console.log("ðŸ”’ User not authenticated for cart action");try{console.log("ðŸ›’ Adding item to cart:",{id:e,name:d,selectedColor:p}),b(!0);let{data:t,error:r}=await h.supabase.from("products").select("id").order("created_at").limit(1).range(e-1,e-1);if(r||!t||0===t.length)throw Error("Product not found");let{data:a,error:s}=await h.supabase.from("product_variants").select("id").eq("product_id",t[0].id).eq("color_hex",p).eq("size","M").single();if(s||!a)throw Error("Product variant not found");await y(a.id),N(!0),console.log("âœ… Item added to cart successfully"),setTimeout(()=>N(!1),2e3)}catch(e){console.error("âŒ Failed to add item to cart:",e)}finally{b(!1)}},_=j?{icon:l.ShoppingCart,text:"Adding..."}:C?{icon:o.Check,text:"Added!"}:{icon:l.ShoppingCart,text:"Add to cart"};return(0,t.jsxs)(a.Card,{className:"overflow-hidden group bg-white","data-testid":`tshirt-card-${e}`,children:[(0,t.jsxs)("div",{className:"relative pb-[125%] overflow-hidden",children:[(0,t.jsx)(u,{image:x,alt:d,children:(0,t.jsx)("img",{src:x,alt:d,className:"absolute inset-0 w-full h-full object-cover object-center transition-transform duration-300 group-hover:scale-105 cursor-pointer"})}),(0,t.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors duration-300 pointer-events-none"}),(0,t.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 p-4 translate-y-full group-hover:translate-y-0 transition-transform duration-300 flex gap-2 justify-center",children:[(0,t.jsx)(f,{product:{id:e.toString(),name:d,price:m,image:x,colorOptions:g},onAddToCart:(e,t)=>w(),children:(0,t.jsxs)(s.Button,{variant:"secondary",size:"sm",className:"opacity-90 flex items-center gap-1",children:[(0,t.jsx)(i.Eye,{size:16}),(0,t.jsx)("span",{children:"Quick view"})]})}),(0,t.jsxs)(s.Button,{size:"sm",className:`opacity-90 flex items-center gap-1 transition-colors ${C?"bg-green-600 hover:bg-green-700":""}`,onClick:w,disabled:j||!S,"data-testid":"add-to-cart-button",children:[(0,t.jsx)(_.icon,{size:16}),(0,t.jsx)("span",{children:_.text})]})]})]}),(0,t.jsxs)(a.CardContent,{className:"pt-4",children:[(0,t.jsx)(f,{product:{id:e.toString(),name:d,price:m,image:x,colorOptions:g},onAddToCart:(e,t)=>w(),children:(0,t.jsx)("h3",{className:"font-medium hover:text-blue-600 transition-colors cursor-pointer",children:d})}),(0,t.jsx)("p",{className:"text-lg font-medium mt-1",children:m})]})]})}],53788)}]);