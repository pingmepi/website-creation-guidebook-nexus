(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,39435,e=>{"use strict";var s=e.i(43476),a=e.i(71645),t=e.i(33277),r=e.i(93479),d=e.i(19455),i=e.i(10204),l=e.i(15288),n=e.i(81140),o=e.i(30030),c=e.i(42727),u=e.i(96626),m=e.i(48425),h=e.i(86318),p=e.i(69340),f=e.i(10772),x="Tabs",[y,j]=(0,o.createContextScope)(x,[c.createRovingFocusGroupScope]),g=(0,c.createRovingFocusGroupScope)(),[v,b]=y(x),w=a.forwardRef((e,a)=>{let{__scopeTabs:t,value:r,onValueChange:d,defaultValue:i,orientation:l="horizontal",dir:n,activationMode:o="automatic",...c}=e,u=(0,h.useDirection)(n),[x,y]=(0,p.useControllableState)({prop:r,onChange:d,defaultProp:i});return(0,s.jsx)(v,{scope:t,baseId:(0,f.useId)(),value:x,onValueChange:y,orientation:l,dir:u,activationMode:o,children:(0,s.jsx)(m.Primitive.div,{dir:u,"data-orientation":l,...c,ref:a})})});w.displayName=x;var N="TabsList",C=a.forwardRef((e,a)=>{let{__scopeTabs:t,loop:r=!0,...d}=e,i=b(N,t),l=g(t);return(0,s.jsx)(c.Root,{asChild:!0,...l,orientation:i.orientation,dir:i.dir,loop:r,children:(0,s.jsx)(m.Primitive.div,{role:"tablist","aria-orientation":i.orientation,...d,ref:a})})});C.displayName=N;var _="TabsTrigger",P=a.forwardRef((e,a)=>{let{__scopeTabs:t,value:r,disabled:d=!1,...i}=e,l=b(_,t),o=g(t),u=D(l.baseId,r),h=I(l.baseId,r),p=r===l.value;return(0,s.jsx)(c.Item,{asChild:!0,...o,focusable:!d,active:p,children:(0,s.jsx)(m.Primitive.button,{type:"button",role:"tab","aria-selected":p,"aria-controls":h,"data-state":p?"active":"inactive","data-disabled":d?"":void 0,disabled:d,id:u,...i,ref:a,onMouseDown:(0,n.composeEventHandlers)(e.onMouseDown,e=>{d||0!==e.button||!1!==e.ctrlKey?e.preventDefault():l.onValueChange(r)}),onKeyDown:(0,n.composeEventHandlers)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&l.onValueChange(r)}),onFocus:(0,n.composeEventHandlers)(e.onFocus,()=>{let e="manual"!==l.activationMode;p||d||!e||l.onValueChange(r)})})})});P.displayName=_;var F="TabsContent",S=a.forwardRef((e,t)=>{let{__scopeTabs:r,value:d,forceMount:i,children:l,...n}=e,o=b(F,r),c=D(o.baseId,d),h=I(o.baseId,d),p=d===o.value,f=a.useRef(p);return a.useEffect(()=>{let e=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,s.jsx)(u.Presence,{present:i||p,children:({present:a})=>(0,s.jsx)(m.Primitive.div,{"data-state":p?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":c,hidden:!a,id:h,tabIndex:0,...n,ref:t,style:{...e.style,animationDuration:f.current?"0s":void 0},children:a&&l})})});function D(e,s){return`${e}-trigger-${s}`}function I(e,s){return`${e}-content-${s}`}S.displayName=F;var A=e.i(75157);let E=a.forwardRef(({className:e,...a},t)=>(0,s.jsx)(C,{ref:t,className:(0,A.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...a}));E.displayName=C.displayName;let q=a.forwardRef(({className:e,...a},t)=>(0,s.jsx)(P,{ref:t,className:(0,A.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...a}));q.displayName=P.displayName;let k=a.forwardRef(({className:e,...a},t)=>(0,s.jsx)(S,{ref:t,className:(0,A.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...a}));k.displayName=S.displayName;var T=e.i(41867),L=e.i(46696),R=e.i(50965),U=e.i(16019),B=e.i(76639);function H(){let{user:e,isLoading:n}=(0,t.useUser)(),[o,c]=(0,a.useState)(!1),[u,m]=(0,a.useState)({fullName:e?.name||"",email:e?.email||""}),[h,p]=(0,a.useState)([]),[f,x]=(0,a.useState)(!1),[y,j]=(0,a.useState)(null),[g,v]=(0,a.useState)({name:"",street_address:"",city:"",state:"",postal_code:"",country:"United States",is_default:!1});(0,a.useEffect)(()=>{if(e){let s=async()=>{try{let{data:s,error:a}=await T.supabase.from("addresses").select("*").eq("user_id",e.id).order("is_default",{ascending:!1});if(a)throw a;p(s||[])}catch(e){console.error("Error fetching addresses:",e)}};(async()=>{try{let{data:s,error:a}=await T.supabase.from("profiles").select("full_name, avatar_url").eq("id",e.id).single();if(a)throw a;m({fullName:s.full_name||"",email:e.email})}catch(e){console.error("Error fetching profile data:",e)}})(),s()}},[e]);let b=e=>{let{name:s,value:a}=e.target;m(e=>({...e,[s]:a}))},N=async s=>{if(s.preventDefault(),e)try{c(!0);let{error:s}=await T.supabase.from("profiles").update({full_name:u.fullName.replace(/<[^>]*>/g,"").trim()}).eq("id",e.id);if(s)throw s;L.toast.success("Profile updated successfully")}catch(e){console.error("Error updating profile:",e),L.toast.error("Failed to update profile")}finally{c(!1)}},C=async e=>{e.preventDefault();let s=new FormData(e.currentTarget),a=s.get("newPassword");if(a!==s.get("confirmPassword"))return void L.toast.error("Passwords do not match");try{c(!0);let{error:s}=await T.supabase.auth.updateUser({password:a});if(s)throw s;L.toast.success("Password updated successfully"),e.target.reset()}catch(s){console.error("Error updating password:",s);let e=s instanceof Error?s.message:"Failed to update password";L.toast.error(e)}finally{c(!1)}},_=e=>{let{name:s,value:a,type:t,checked:r}=e.target;v(e=>({...e,[s]:"checkbox"===t?r:a}))},P=()=>{v({name:"",street_address:"",city:"",state:"",postal_code:"",country:"United States",is_default:!1}),j(null)},F=async s=>{if(s.preventDefault(),e)try{if(c(!0),g.is_default&&await T.supabase.from("addresses").update({is_default:!1}).eq("user_id",e.id),y){let e=e=>e.replace(/<[^>]*>/g,"").trim(),{error:s}=await T.supabase.from("addresses").update({name:e(g.name),street_address:e(g.street_address),city:e(g.city),state:e(g.state),postal_code:e(g.postal_code),country:e(g.country),is_default:g.is_default,updated_at:new Date().toISOString()}).eq("id",y.id);if(s)throw s;L.toast.success("Address updated successfully")}else{let s=e=>e.replace(/<[^>]*>/g,"").trim(),{error:a}=await T.supabase.from("addresses").insert({user_id:e.id,name:s(g.name),street_address:s(g.street_address),city:s(g.city),state:s(g.state),postal_code:s(g.postal_code),country:s(g.country),is_default:g.is_default});if(a)throw a;L.toast.success("Address added successfully")}let{data:s,error:a}=await T.supabase.from("addresses").select("*").eq("user_id",e.id).order("is_default",{ascending:!1});if(a)throw a;p(s||[]),x(!1),P()}catch(e){console.error("Error saving address:",e),L.toast.error("Failed to save address")}finally{c(!1)}},S=async s=>{if(e)try{let{error:e}=await T.supabase.from("addresses").delete().eq("id",s);if(e)throw e;p(h.filter(e=>e.id!==s)),L.toast.success("Address deleted successfully")}catch(e){console.error("Error deleting address:",e),L.toast.error("Failed to delete address")}},D=()=>{P(),x(!0)};return n?(0,s.jsx)("div",{children:"Loading..."}):(0,s.jsxs)(w,{defaultValue:"details",children:[(0,s.jsxs)(E,{className:"mb-4",children:[(0,s.jsx)(q,{value:"details",children:"Profile Details"}),(0,s.jsx)(q,{value:"addresses",children:"Addresses"}),(0,s.jsx)(q,{value:"security",children:"Security"})]}),(0,s.jsx)(k,{value:"details",children:(0,s.jsxs)(l.Card,{children:[(0,s.jsxs)(l.CardHeader,{children:[(0,s.jsx)(l.CardTitle,{children:"Personal Information"}),(0,s.jsx)(l.CardDescription,{children:"Update your personal details here."})]}),(0,s.jsxs)("form",{onSubmit:N,children:[(0,s.jsxs)(l.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{htmlFor:"fullName",children:"Full Name"}),(0,s.jsx)(r.Input,{id:"fullName",name:"fullName",value:u.fullName,onChange:b,placeholder:"Your full name"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{htmlFor:"email",children:"Email Address"}),(0,s.jsx)(r.Input,{id:"email",name:"email",value:u.email,onChange:b,placeholder:"Your email",disabled:!0}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Email cannot be changed. Contact support if you need to update it."})]})]}),(0,s.jsx)(l.CardFooter,{children:(0,s.jsx)(d.Button,{type:"submit",disabled:o,children:o?"Updating...":"Update Profile"})})]})]})}),(0,s.jsxs)(k,{value:"addresses",children:[(0,s.jsxs)(l.Card,{children:[(0,s.jsxs)(l.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(l.CardTitle,{children:"Your Addresses"}),(0,s.jsx)(l.CardDescription,{children:"Manage your shipping and billing addresses."})]}),(0,s.jsx)(d.Button,{onClick:D,children:"Add New Address"})]}),(0,s.jsx)(l.CardContent,{children:0===h.length?(0,s.jsxs)("div",{className:"text-center py-6",children:[(0,s.jsx)(R.ShoppingBag,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,s.jsx)("h3",{className:"mt-2 text-sm font-semibold text-gray-900",children:"No addresses"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"You haven't added any addresses yet."}),(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsx)(d.Button,{onClick:D,children:"Add your first address"})})]}):(0,s.jsx)("div",{className:"grid gap-4",children:h.map(e=>(0,s.jsxs)("div",{className:`border p-4 rounded-md relative ${e.is_default?"bg-blue-50 border-blue-200":""}`,children:[e.is_default&&(0,s.jsx)("span",{className:"absolute top-2 right-2 bg-blue-100 text-blue-800 text-xs font-medium px-2 py-0.5 rounded",children:"Default"}),(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium",children:e.name}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:e.street_address}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[e.city,", ",e.state," ",e.postal_code]}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:e.country})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(d.Button,{variant:"outline",size:"sm",onClick:()=>{j(e),v({name:e.name,street_address:e.street_address,city:e.city,state:e.state,postal_code:e.postal_code,country:e.country,is_default:e.is_default}),x(!0)},children:"Edit"}),(0,s.jsx)(d.Button,{variant:"outline",size:"icon",onClick:()=>S(e.id),className:"text-red-500 hover:text-red-600",children:(0,s.jsx)(U.Trash,{className:"h-4 w-4"})})]})]})]},e.id))})})]}),(0,s.jsx)(B.Dialog,{open:f,onOpenChange:x,children:(0,s.jsxs)(B.DialogContent,{className:"sm:max-w-[500px]",children:[(0,s.jsx)(B.DialogHeader,{children:(0,s.jsx)(B.DialogTitle,{children:y?"Edit Address":"Add New Address"})}),(0,s.jsxs)("form",{onSubmit:F,children:[(0,s.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{htmlFor:"name",children:"Address Name (e.g., Home, Work)"}),(0,s.jsx)(r.Input,{id:"name",name:"name",value:g.name,onChange:_,placeholder:"Home",required:!0})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{htmlFor:"street_address",children:"Street Address"}),(0,s.jsx)(r.Input,{id:"street_address",name:"street_address",value:g.street_address,onChange:_,placeholder:"123 Main St",required:!0})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{htmlFor:"city",children:"City"}),(0,s.jsx)(r.Input,{id:"city",name:"city",value:g.city,onChange:_,placeholder:"New York",required:!0})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{htmlFor:"state",children:"State"}),(0,s.jsx)(r.Input,{id:"state",name:"state",value:g.state,onChange:_,placeholder:"NY",required:!0})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{htmlFor:"postal_code",children:"Postal Code"}),(0,s.jsx)(r.Input,{id:"postal_code",name:"postal_code",value:g.postal_code,onChange:_,placeholder:"10001",required:!0})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{htmlFor:"country",children:"Country"}),(0,s.jsx)(r.Input,{id:"country",name:"country",value:g.country,onChange:_,placeholder:"United States",required:!0})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("input",{type:"checkbox",id:"is_default",name:"is_default",checked:g.is_default,onChange:_,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,s.jsx)(i.Label,{htmlFor:"is_default",className:"font-normal",children:"Set as default address"})]})]}),(0,s.jsxs)(B.DialogFooter,{children:[(0,s.jsx)(d.Button,{type:"button",variant:"outline",onClick:()=>x(!1),children:"Cancel"}),(0,s.jsx)(d.Button,{type:"submit",disabled:o,children:o?"Saving...":y?"Update":"Add"})]})]})]})})]}),(0,s.jsx)(k,{value:"security",children:(0,s.jsxs)(l.Card,{children:[(0,s.jsxs)(l.CardHeader,{children:[(0,s.jsx)(l.CardTitle,{children:"Change Password"}),(0,s.jsx)(l.CardDescription,{children:"Update your password to keep your account secure."})]}),(0,s.jsxs)("form",{onSubmit:C,children:[(0,s.jsxs)(l.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{htmlFor:"newPassword",children:"New Password"}),(0,s.jsx)(r.Input,{id:"newPassword",name:"newPassword",type:"password",placeholder:"New password",required:!0})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{htmlFor:"confirmPassword",children:"Confirm New Password"}),(0,s.jsx)(r.Input,{id:"confirmPassword",name:"confirmPassword",type:"password",placeholder:"Confirm new password",required:!0})]})]}),(0,s.jsx)(l.CardFooter,{children:(0,s.jsx)(d.Button,{type:"submit",disabled:o,children:o?"Updating...":"Change Password"})})]})]})})]})}e.s(["default",()=>H],39435)}]);