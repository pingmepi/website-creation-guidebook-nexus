module.exports=[91119,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...c}));e.displayName="Card";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",a),...c}));f.displayName="CardHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("h3",{ref:e,className:(0,d.cn)("text-2xl font-semibold leading-none tracking-tight",a),...c}));g.displayName="CardTitle";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("p",{ref:e,className:(0,d.cn)("text-sm text-muted-foreground",a),...c}));h.displayName="CardDescription";let i=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("p-6 pt-0",a),...c}));i.displayName="CardContent";let j=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex items-center p-6 pt-0",a),...c}));j.displayName="CardFooter",a.s(["Card",()=>e,"CardContent",()=>i,"CardDescription",()=>h,"CardFooter",()=>j,"CardHeader",()=>f,"CardTitle",()=>g])},77994,a=>{"use strict";var b=a.i(72131);function c(a){let c=b.useRef({value:a,previous:a});return b.useMemo(()=>(c.current.value!==a&&(c.current.previous=c.current.value,c.current.value=a),c.current.previous),[a])}a.s(["usePrevious",()=>c])},34434,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(91119),e=a.i(99570),f=a.i(77156),g=a.i(38784),h=a.i(33441),i=a.i(35475),j=a.i(35911),k=a.i(14574);let l=({children:a,image:c,alt:d})=>(0,b.jsxs)(k.Dialog,{children:[(0,b.jsx)(k.DialogTrigger,{asChild:!0,children:a}),(0,b.jsx)(k.DialogContent,{className:"max-w-3xl w-full max-h-[90vh] p-0",children:(0,b.jsx)("div",{className:"relative",children:(0,b.jsx)("img",{src:c,alt:d,className:"w-full h-auto object-contain rounded-lg"})})})]});var m=a.i(80701),n=a.i(74167),o=a.i(54614);let p=({children:a,product:d,onAddToCart:f})=>{let[h,i]=(0,c.useState)(""),[j,l]=(0,c.useState)(1),{sizes:p,colors:q,loading:r,selectedSize:s,setSelectedSize:t,checkStock:u}=function(a){let[b,d]=(0,c.useState)([]),[e,f]=(0,c.useState)([]),[g,h]=(0,c.useState)(!1),[i,j]=(0,c.useState)("");return(0,c.useEffect)(()=>{a&&(async()=>{h(!0);try{let{data:b,error:c}=await n.supabase.rpc("get_product_sizes",{product_uuid:a});if(c)return void console.error("Error fetching product sizes:",c);d(b||[]),b&&b.length>0&&j(b[0].size)}catch(a){console.error("Error fetching product sizes:",a)}finally{h(!1)}})()},[a]),(0,c.useEffect)(()=>{a&&i&&(async()=>{try{let{data:b,error:c}=await n.supabase.rpc("get_product_colors",{product_uuid:a,size_param:i});if(c)return void console.error("Error fetching product colors:",c);f(b||[])}catch(a){console.error("Error fetching product colors:",a)}})()},[a,i]),{sizes:b,colors:e,loading:g,selectedSize:i,setSelectedSize:j,checkStock:async(a,b=1)=>{try{let{data:c,error:d}=await n.supabase.rpc("check_variant_stock",{variant_uuid:a,requested_quantity:b});if(d)return console.error("Error checking stock:",d),!1;return c}catch(a){return console.error("Error checking stock:",a),!1}}}}(d.id),v=async()=>{if(!s)return void(0,o.toast)({title:"Please select a size",variant:"destructive"});let a=q.find(a=>h?a.color_hex===h:a.variant_id);a?await u(a.variant_id,j)?f(a.variant_id,j):(0,o.toast)({title:"Out of stock",description:"This item is currently out of stock",variant:"destructive"}):(0,o.toast)({title:"Product not available",description:"Selected size/color combination is not available",variant:"destructive"})};return(0,b.jsxs)(k.Dialog,{children:[(0,b.jsx)(k.DialogTrigger,{asChild:!0,children:a}),(0,b.jsxs)(k.DialogContent,{className:"max-w-2xl",children:[(0,b.jsx)(k.DialogHeader,{children:(0,b.jsx)(k.DialogTitle,{children:d.name})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsx)("div",{className:"aspect-square",children:(0,b.jsx)("img",{src:d.image,alt:d.name,className:"w-full h-full object-cover rounded-lg"})}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-xl font-semibold",children:d.name}),(0,b.jsx)("p",{className:"text-2xl font-bold text-primary mt-2",children:d.price})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-2",children:"Description"}),(0,b.jsx)("p",{className:"text-muted-foreground text-sm",children:"Premium quality t-shirt made from 100% cotton. Comfortable fit with excellent durability and softness."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-2",children:"Size"}),(0,b.jsxs)(m.Select,{value:s,onValueChange:t,disabled:r,children:[(0,b.jsx)(m.SelectTrigger,{className:"w-full",children:(0,b.jsx)(m.SelectValue,{placeholder:r?"Loading sizes...":"Select size"})}),(0,b.jsx)(m.SelectContent,{children:p.map(a=>(0,b.jsxs)(m.SelectItem,{value:a.size,disabled:0===a.available_stock,children:[a.size," ",0===a.available_stock?"(Out of Stock)":`(${a.available_stock} available)`]},a.size))})]})]}),s&&q.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-2",children:"Color"}),(0,b.jsxs)(m.Select,{value:h,onValueChange:i,children:[(0,b.jsx)(m.SelectTrigger,{className:"w-full",children:(0,b.jsx)(m.SelectValue,{placeholder:"Select color"})}),(0,b.jsx)(m.SelectContent,{children:q.map(a=>(0,b.jsx)(m.SelectItem,{value:a.color_hex,disabled:0===a.stock_quantity,children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-4 h-4 rounded border",style:{backgroundColor:a.color_hex}}),a.color_name," (",a.stock_quantity," available)"]})},a.variant_id))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-2",children:"Quantity"}),(0,b.jsxs)(m.Select,{value:j.toString(),onValueChange:a=>l(parseInt(a)),children:[(0,b.jsx)(m.SelectTrigger,{className:"w-full",children:(0,b.jsx)(m.SelectValue,{})}),(0,b.jsx)(m.SelectContent,{children:[1,2,3,4,5].map(a=>(0,b.jsx)(m.SelectItem,{value:a.toString(),children:a},a))})]})]}),(0,b.jsxs)(e.Button,{onClick:v,className:"w-full flex items-center gap-2",disabled:!s||r,children:[(0,b.jsx)(g.ShoppingCart,{size:20}),"Add to Cart"]})]})]})]})]})};a.s(["default",0,({id:a,name:k,price:m,image:o,colorOptions:q=["#FFFFFF","#000000","#DC2626"]})=>{let[r,s]=(0,c.useState)(q[0]),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(!1),{isAuthenticated:x}=(0,i.useUser)(),{addToCart:y}=(0,j.useCart)(),z=async()=>{if(!x)return void console.log("ðŸ”’ User not authenticated for cart action");try{console.log("ðŸ›’ Adding item to cart:",{id:a,name:k,selectedColor:r}),u(!0);let{data:b,error:c}=await n.supabase.from("products").select("id").order("created_at").limit(1).range(a-1,a-1);if(c||!b||0===b.length)throw Error("Product not found");let{data:d,error:e}=await n.supabase.from("product_variants").select("id").eq("product_id",b[0].id).eq("color_hex",r).eq("size","M").single();if(e||!d)throw Error("Product variant not found");await y(d.id),w(!0),console.log("âœ… Item added to cart successfully"),setTimeout(()=>w(!1),2e3)}catch(a){console.error("âŒ Failed to add item to cart:",a)}finally{u(!1)}},A=t?{icon:g.ShoppingCart,text:"Adding..."}:v?{icon:h.Check,text:"Added!"}:{icon:g.ShoppingCart,text:"Add to cart"};return(0,b.jsxs)(d.Card,{className:"overflow-hidden group bg-white","data-testid":`tshirt-card-${a}`,children:[(0,b.jsxs)("div",{className:"relative pb-[125%] overflow-hidden",children:[(0,b.jsx)(l,{image:o,alt:k,children:(0,b.jsx)("img",{src:o,alt:k,className:"absolute inset-0 w-full h-full object-cover object-center transition-transform duration-300 group-hover:scale-105 cursor-pointer"})}),(0,b.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors duration-300 pointer-events-none"}),(0,b.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 p-4 translate-y-full group-hover:translate-y-0 transition-transform duration-300 flex gap-2 justify-center",children:[(0,b.jsx)(p,{product:{id:a.toString(),name:k,price:m,image:o,colorOptions:q},onAddToCart:(a,b)=>z(),children:(0,b.jsxs)(e.Button,{variant:"secondary",size:"sm",className:"opacity-90 flex items-center gap-1",children:[(0,b.jsx)(f.Eye,{size:16}),(0,b.jsx)("span",{children:"Quick view"})]})}),(0,b.jsxs)(e.Button,{size:"sm",className:`opacity-90 flex items-center gap-1 transition-colors ${v?"bg-green-600 hover:bg-green-700":""}`,onClick:z,disabled:t||!x,"data-testid":"add-to-cart-button",children:[(0,b.jsx)(A.icon,{size:16}),(0,b.jsx)("span",{children:A.text})]})]})]}),(0,b.jsxs)(d.CardContent,{className:"pt-4",children:[(0,b.jsx)(p,{product:{id:a.toString(),name:k,price:m,image:o,colorOptions:q},onAddToCart:(a,b)=>z(),children:(0,b.jsx)("h3",{className:"font-medium hover:text-blue-600 transition-colors cursor-pointer",children:k})}),(0,b.jsx)("p",{className:"text-lg font-medium mt-1",children:m})]})]})}],34434)}];

//# sourceMappingURL=_b5bc2b90._.js.map